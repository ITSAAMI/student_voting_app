<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Student Task Voting System</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Animate.css for subtle animations -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <style>
    :root{--accent:#2b9bf4;--muted:#6c757d}
    body{background:linear-gradient(180deg,#f6fbff 0%, #ffffff 100%);font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    .card-soft{border-radius:12px;box-shadow:0 6px 18px rgba(50,50,93,0.06);}
    .badge-student{margin:4px}
    .hidden{display:none}
    .winner{padding:18px;border-radius:12px;background:linear-gradient(90deg,rgba(43,155,244,0.06),rgba(255,235,59,0.03));border:1px solid rgba(43,155,244,0.12)}
    .small-muted{color:var(--muted)}
  </style>
</head>
<body>

<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <div class="card card-soft p-4">
        <div class="d-flex align-items-center mb-3">
          <div>
            <h3 class="mb-0">Student Task Voting System</h3>
            <small class="small-muted">Create quick votes and pick a student at random</small>
          </div>
          <div class="ms-auto text-end">
            <small class="text-muted">Simple • Clean • Fast</small>
          </div>
        </div>

        <div class="row g-4">
          <!-- Left: Controls -->
          <div class="col-md-4">
            <div class="card p-3 mb-3 card-soft">
              <h6>Shortcuts</h6>
              <div class="d-grid gap-2">
                <button class="btn btn-outline-primary shortcut" data-task="Who will wash utensils?">Who will wash utensils?</button>
                <button class="btn btn-outline-primary shortcut" data-task="Who will clean the class?">Who will clean the class?</button>
                <button class="btn btn-outline-primary shortcut" data-task="Who will arrange chairs?">Who will arrange chairs?</button>
                <button class="btn btn-outline-primary shortcut" data-task="Who will maintain discipline?">Who will maintain discipline?</button>
              </div>
            </div>

            <div class="card p-3 card-soft">
              <h6>Add Students</h6>
              <div class="input-group mb-2">
                <input id="student-input" class="form-control" placeholder="Type student name and press Add">
                <button id="add-student" class="btn btn-success">Add</button>
              </div>
              <div id="student-list"></div>
              <button id="create-vote" class="btn btn-primary w-100 mt-3">Create Vote</button>
            </div>

          </div>

          <!-- Right: Main content -->
          <div class="col-md-8">
            <div id="main-card" class="card p-4 card-soft">
              <h5 id="main-title">Welcome</h5>
              <p class="small-muted">Use shortcuts or add students to start a vote. The interface is intentionally minimal for classroom use.</p>

              <!-- Create Vote -->
              <div id="create-section" class="mt-3 hidden">
                <div class="mb-3">
                  <label class="form-label">Task Title</label>
                  <input id="task-title" class="form-control" placeholder="e.g. Today's Utensil Washing">
                </div>
                <div class="mb-3">
                  <label class="form-label">Students</label>
                  <div id="selected-students"></div>
                </div>
                <div class="d-flex gap-2">
                  <button id="start-vote" class="btn btn-success">Start Voting</button>
                  <button id="cancel-vote" class="btn btn-outline-secondary">Cancel</button>
                </div>
              </div>

              <!-- Processing -->
              <div id="processing" class="mt-3 hidden text-center">
                <div class="spinner-border text-primary" role="status"><span class="visually-hidden">Processing...</span></div>
                <p class="mt-2 small-muted">Processing selection...</p>
              </div>

              <!-- Result -->
              <div id="result" class="mt-3 hidden text-center">
                <div class="winner animate__animated animate__fadeInUp">
                  <h2 id="winner-name">--</h2>
                  <p class="mb-0">Selected Student</p>
                </div>
                <div class="mt-3 d-flex justify-content-center gap-2">
                  <button id="new-vote" class="btn btn-primary">New Vote</button>
                  <button id="save-history" class="btn btn-outline-secondary">Save Result</button>
                </div>
              </div>

              <!-- History -->
              <div id="history" class="mt-3 hidden">
                <h6>Voting History</h6>
                <ul id="history-list" class="list-group"></ul>
              </div>

            </div>
          </div>

        </div>

      </div>

      <div class="text-center mt-3 small text-muted">Made for classrooms • Minimal UI</div>
    </div>
  </div>
</div>

<!-- Libraries -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
  // Simple clean voting app (no password)
  const students = JSON.parse(localStorage.getItem('sv_students')||'[]');
  const history = JSON.parse(localStorage.getItem('sv_history')||'[]');

  const studentListEl = document.getElementById('student-list');
  const selectedStudentsEl = document.getElementById('selected-students');
  const historyListEl = document.getElementById('history-list');

  function renderStudents(){
    studentListEl.innerHTML = '';
    students.forEach((s, i)=>{
      const span = document.createElement('div');
      span.className = 'badge bg-primary text-white badge-student d-inline-flex align-items-center';
      span.style.margin = '4px';
      span.innerHTML = `${s} <button data-idx="${i}" class="btn-close btn-close-white btn-sm ms-2" aria-label="Remove"></button>`;
      studentListEl.appendChild(span);
    });
  }

  function renderSelected(){
    selectedStudentsEl.innerHTML = '';
    students.forEach(s=>{
      const b = document.createElement('span');
      b.className = 'badge bg-info text-dark me-1 mb-1';
      b.textContent = s;
      selectedStudentsEl.appendChild(b);
    });
  }

  function renderHistory(){
    historyListEl.innerHTML = '';
    if(history.length===0){ historyListEl.innerHTML = '<li class="list-group-item">No history</li>'; return; }
    history.slice().reverse().forEach(h=>{
      const li = document.createElement('li');
      li.className = 'list-group-item';
      li.innerHTML = `<strong>${h.task}</strong><div class="small text-muted">Winner: ${h.winner} • ${new Date(h.date).toLocaleString()}</div>`;
      historyListEl.appendChild(li);
    });
  }

  renderStudents(); renderHistory();

  // Add student
  document.getElementById('add-student').addEventListener('click', ()=>{
    const input = document.getElementById('student-input');
    const name = input.value.trim();
    if(!name) return; 
    students.push(name);
    localStorage.setItem('sv_students', JSON.stringify(students));
    input.value = '';
    renderStudents();
  });

  // remove student
  studentListEl.addEventListener('click', e=>{
    const btn = e.target.closest('button[aria-label]');
    if(!btn) return;
    const idx = Number(btn.dataset.idx);
    if(Number.isFinite(idx)){
      students.splice(idx,1);
      localStorage.setItem('sv_students', JSON.stringify(students));
      renderStudents();
    }
  });

  // shortcuts
  document.querySelectorAll('.shortcut').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const task = btn.dataset.task;
      openCreate(task);
    });
  });

  document.getElementById('create-vote').addEventListener('click', ()=>openCreate());

  function openCreate(task=''){
    document.getElementById('main-title').textContent = 'Create Vote';
    document.getElementById('create-section').classList.remove('hidden');
    document.getElementById('processing').classList.add('hidden');
    document.getElementById('result').classList.add('hidden');
    document.getElementById('history').classList.add('hidden');
    document.getElementById('task-title').value = task;
    renderSelected();
  }

  document.getElementById('cancel-vote').addEventListener('click', ()=>{
    document.getElementById('create-section').classList.add('hidden');
    document.getElementById('main-title').textContent = 'Welcome';
  });

  let currentTask = null;
  let currentWinner = null;

  document.getElementById('start-vote').addEventListener('click', ()=>{
    const title = document.getElementById('task-title').value.trim() || 'Untitled Task';
    if(students.length===0){ alert('Add at least one student'); return; }
    currentTask = title;
    // show processing
    document.getElementById('create-section').classList.add('hidden');
    document.getElementById('processing').classList.remove('hidden');
    // simulate processing
    setTimeout(()=>{
      document.getElementById('processing').classList.add('hidden');
      const idx = Math.floor(Math.random()*students.length);
      currentWinner = students[idx];
      document.getElementById('winner-name').textContent = currentWinner;
      document.getElementById('result').classList.remove('hidden');
      // confetti
      confetti({particleCount:120,spread:70});
    }, 1100);
  });

  document.getElementById('new-vote').addEventListener('click', ()=>{
    document.getElementById('result').classList.add('hidden');
    document.getElementById('create-section').classList.remove('hidden');
  });

  document.getElementById('save-history').addEventListener('click', ()=>{
    if(!currentTask || !currentWinner){ alert('No result to save'); return; }
    history.push({task:currentTask,winner:currentWinner,date:Date.now()});
    localStorage.setItem('sv_history', JSON.stringify(history));
    renderHistory();
    alert('Saved');
  });

</script>
</body>
</html>

